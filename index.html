<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, viewport-fit=cover" />
<title>Lovingly Framed</title>

<style>
:root{
  --bg:#fff7fb;
  --bg2:#fde8f2;
  --card:#ffffff;
  --text:#6a3d57;
  --muted:#9b6f86;
  --stroke:rgba(0,0,0,.06);
  --shadow:0 6px 12px rgba(233,133,179,.12);
  --radius:16px;
  --wa:#23D366;
  --ph:#f3e6ee;
}

*{box-sizing:border-box;margin:0;padding:0;}
html,body{height:100%;}
body{
  font-family:system-ui,-apple-system,Tahoma,Arial;
  background:linear-gradient(180deg,var(--bg),var(--bg2));
  color:var(--text);
  overflow-x:hidden;
  padding-top:env(safe-area-inset-top);
  padding-bottom:env(safe-area-inset-bottom);
}

.container{max-width:560px;margin:0 auto;padding:12px;}
.view-hidden{display:none!important;}

/* Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø¹Ù„ÙˆÙŠ */
.top-bar{
  position:sticky;
  top:env(safe-area-inset-top);
  z-index:100;
  background:rgba(255,255,255,.9);
  backdrop-filter:blur(12px);
  border:1px solid var(--stroke);
  border-radius:var(--radius);
  box-shadow:0 4px 8px rgba(0,0,0,.04);
  padding:12px;
  margin-bottom:12px;
  text-align:center;
}
.top-bar .made{font-size:16px;font-weight:800;}
.top-bar .handle{font-size:15px;font-weight:700;direction:ltr;}

/* Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© */
.home-grid{display:grid;grid-template-columns:1fr 1fr;gap:10px;}
.home-card{
  background:var(--card);
  border-radius:var(--radius);
  box-shadow:var(--shadow);
  overflow:hidden;
  cursor:pointer;
  touch-action:manipulation;
}
.home-card:active{transform:scale(.99);}
.home-card img{
  width:100%;
  height:100%;
  object-fit:cover;
  display:block;
  background:var(--ph);
}

/* Ø²Ø± Ø§Ù„ÙƒØªØ§Ù„ÙˆØ¬ */
.pill-button{
  margin:14px 0;
  padding:12px 16px;
  background:#fff;
  border-radius:999px;
  border:1px solid rgba(255,105,180,.25);
  box-shadow:0 6px 12px rgba(255,105,180,.12);
  font-size:16px;
  font-weight:800;
  display:flex;
  align-items:center;
  justify-content:center;
  gap:8px;
  cursor:pointer;
  touch-action:manipulation;
}
.pill-button:active{transform:scale(.99);}

/* ÙƒØ±Øª Ø§Ù„ØªÙˆØ§ØµÙ„ */
.contact-card{
  background:#fff;
  border-radius:16px;
  box-shadow:0 6px 12px rgba(0,0,0,.05);
  padding:14px;
  text-align:center;
}
.contact-card .title{font-size:12px;font-weight:600;color:var(--muted);margin-bottom:6px;}
.contact-card .phone{font-size:18px;font-weight:700;letter-spacing:.5px;direction:ltr;}

.wa-btn{
  margin-top:10px;
  padding:10px 14px;
  border-radius:14px;
  background:var(--wa);
  color:#fff;
  font-size:14px;
  font-weight:700;
  display:flex;
  align-items:center;
  justify-content:center;
  gap:10px;
  box-shadow:0 6px 12px rgba(35,211,102,.18);
  border:none;
  width:100%;
  cursor:pointer;
  touch-action:manipulation;
}
.wa-btn:active{transform:scale(.99);}
.wa-icon{
  width:28px;height:28px;
  border-radius:50%;
  background:#fff;
  display:flex;
  align-items:center;
  justify-content:center;
  flex:0 0 auto;
}
.wa-icon svg{width:16px;height:16px;fill:var(--wa);}

/* Ø§Ù„ÙƒØªØ§Ù„ÙˆØ¬ */
.catalog-header{
  position:sticky;
  top:calc(env(safe-area-inset-top) + 0px);
  z-index:50;
  background:rgba(255,255,255,.9);
  backdrop-filter:blur(10px);
  border-radius:var(--radius);
  padding:10px;
  margin-bottom:10px;
  display:flex;
  align-items:center;
  gap:10px;
  box-shadow:0 4px 8px rgba(0,0,0,.04);
  border:1px solid var(--stroke);
}
.back-button{
  border:none;
  background:#fff;
  border-radius:12px;
  padding:8px 12px;
  box-shadow:0 4px 8px rgba(0,0,0,.05);
  cursor:pointer;
  font-weight:800;
}
.catalog-title{flex:1;text-align:center;font-weight:800;}

/* FEED (Ù…Ø±ØªØ¨ + Ù†Ù‡Ø§ÙŠØ© ÙˆØ§Ø¶Ø­Ø©) */
.feed{
  display:flex;
  flex-direction:column;
  gap:16px;
}
.post{
  background:#fff;
  border-radius:var(--radius);
  box-shadow:var(--shadow);
  overflow:hidden;
  border:1px solid var(--stroke);
}
.post .ph{
  background:var(--ph);
  width:100%;
  aspect-ratio: 9 / 16;
}
.post img{
  width:100%;
  height:auto;
  display:block;
  background:var(--ph);
}

/* Ø²Ø± ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø²ÙŠØ¯ + Ù†Ù‡Ø§ÙŠØ© */
.load-more{
  margin:10px 0 20px;
  padding:12px 14px;
  width:100%;
  border:none;
  border-radius:14px;
  background:#fff;
  box-shadow:0 6px 12px rgba(0,0,0,.05);
  font-weight:900;
  cursor:pointer;
}
.end-note{
  text-align:center;
  color:var(--muted);
  font-weight:800;
  padding:18px 10px 28px;
}

/* Ø±Ø³Ø§Ù„Ø© */
.msg{
  text-align:center;
  color:var(--muted);
  padding:24px 10px;
  font-weight:700;
}
</style>
</head>

<body>
<div class="container">

  <div class="top-bar">
    <div class="made">ØµÙÙ†Ø¹ Ø¨Ø­Ø¨ ğŸ¤</div>
    <div class="handle">lovingly.framed</div>
  </div>

  <!-- HOME -->
  <section id="homeView">
    <div class="home-grid">
      <div class="home-card" onclick="openCatalog('bridal')">
        <img id="thumbBridal" src="images/bridal/1.jpg" alt="Ø§Ù„Ø¹Ø±ÙˆØ³" loading="eager" decoding="async">
      </div>
      <div class="home-card" onclick="openCatalog('newborn')">
        <img id="thumbNewborn" src="images/newborn/1.jpg" alt="Ø§Ù„Ù…ÙˆØ§Ù„ÙŠØ¯" loading="eager" decoding="async">
      </div>
      <div class="home-card" onclick="openCatalog('balloons')">
        <img id="thumbBalloons" src="images/balloons/1.jpg" alt="Ø§Ù„Ø¨Ø§Ù„ÙˆÙ†Ø§Øª" loading="eager" decoding="async">
      </div>
      <div class="home-card" onclick="openCatalog('grad')">
        <img id="thumbGrad" src="images/grad/1.jpg" alt="Ø§Ù„ØªØ®Ø±Ø¬" loading="eager" decoding="async">
      </div>
    </div>

    <div class="pill-button" onclick="openCatalog('all')">ğŸ“ Ø§Ù„ÙƒØªØ§Ù„ÙˆØ¬ Ø§Ù„ÙƒØ§Ù…Ù„</div>

    <div class="contact-card">
      <div class="title">Ù„Ù„ØªÙˆØ§ØµÙ„</div>
      <div class="phone">+965 6502 2191</div>

      <button class="wa-btn" onclick="window.open('https://wa.me/96565022191')">
        <span>ØªÙˆØ§ØµÙ„ ÙˆØ§ØªØ³Ø§Ø¨</span>
        <span class="wa-icon" aria-hidden="true">
          <svg viewBox="0 0 32 32">
            <path d="M16.7 1.1c-7.7 0-14 6.3-14 14 0 2.5.7 4.9 1.9 7L2.6 30.9l9-2c2.1 1.1 4.4 1.7 6.8 1.7 7.7 0 14-6.3 14-14S24.4 1.1 16.7 1.1z"/>
          </svg>
        </span>
      </button>
    </div>
  </section>

  <!-- CATALOG -->
  <section id="catalogView" class="view-hidden">
    <div class="catalog-header">
      <button class="back-button" onclick="goBack()">â†</button>
      <div class="catalog-title" id="catalogTitle">Ø§Ù„ÙƒØªØ§Ù„ÙˆØ¬</div>
      <div style="width:42px;"></div>
    </div>

    <div class="feed" id="feed">
      <div class="msg">Ø§Ø®ØªØ± Ù‚Ø³Ù… Ù„Ø¹Ø±Ø¶ Ø§Ù„ØµÙˆØ±</div>
    </div>
  </section>

</div>

<script>
const IMAGE_ROOT = "images";
const EXT = "jpg";

/* Ù…Ù‡Ù…:
- 1.jpg Ù„Ù„Ù€ thumbnails ÙÙ‚Ø·.
- Ø¯Ø§Ø®Ù„ Ø§Ù„ÙƒØªØ§Ù„ÙˆØ¬ Ù†Ø¨Ø¯Ø£ Ù…Ù† 2.jpg Ø¹Ø´Ø§Ù† Ù…Ø§ ØªØªÙƒØ±Ø±.
*/
const START_INDEX_IN_CATALOG = 2;

/* Ø­Ø¯ Ù…Ù†Ø·Ù‚ÙŠ Ù„ÙƒÙ„ ÙÙˆÙ„Ø¯Ø± Ø¹Ø´Ø§Ù† Ù…Ø§ ÙŠØµÙŠØ± â€œÙ…Ø§Ù„Ø§Ù†Ù‡Ø§ÙŠØ©â€ */
const MAX_PER_FOLDER = 200;

/* ÙƒÙ… ØµÙˆØ±Ø© Ù†Ø­Ù…Ù„ ÙƒÙ„ Ø¯ÙØ¹Ø© */
const PAGE_SIZE = 12;

const titles = {
  bridal: 'Ø§Ù„Ø¹Ø±ÙˆØ³',
  newborn: 'Ø§Ù„Ù…ÙˆØ§Ù„ÙŠØ¯',
  balloons: 'Ø§Ù„Ø¨Ø§Ù„ÙˆÙ†Ø§Øª',
  grad: 'Ø§Ù„ØªØ®Ø±Ø¬',
  all: 'Ø§Ù„ÙƒØªØ§Ù„ÙˆØ¬ Ø§Ù„ÙƒØ§Ù…Ù„'
};

const folders = ["bridal","newborn","balloons","grad"];

const homeView = document.getElementById('homeView');
const catalogView = document.getElementById('catalogView');
const catalogTitle = document.getElementById('catalogTitle');
const feed = document.getElementById('feed');

/* Ø­ÙØ¸ Ø³ÙƒØ±ÙˆÙ„ Ù„ÙƒÙ„ Ù‚Ø³Ù… Ø¹Ø´Ø§Ù† Ù„Ù…Ø§ ØªØ±Ø¬Ø¹ ÙŠØ±Ø¬Ø¹ Ù†ÙØ³ Ù…ÙƒØ§Ù†Ùƒ */
const scrollMemory = {}; // {cat: scrollY}
let currentCat = null;

/* Lazy loading */
let io = null;
function ensureObserver(){
  if(io) return;
  io = new IntersectionObserver((entries) => {
    entries.forEach(e => {
      if(!e.isIntersecting) return;
      const img = e.target;
      const src = img.getAttribute("data-src");
      if(src){
        img.src = src;
        img.removeAttribute("data-src");
      }
      io.unobserve(img);
    });
  }, { root: null, rootMargin: "900px 0px", threshold: 0.01 });
}

function makePost(url){
  const post = document.createElement('div');
  post.className = 'post';
  post.innerHTML = `
    <div class="ph"></div>
    <img data-src="${url}" alt="ØµÙˆØ±Ø©" decoding="async" loading="lazy">
  `;

  const img = post.querySelector("img");
  const ph = post.querySelector(".ph");

  img.addEventListener("load", () => { if(ph) ph.remove(); });
  img.addEventListener("error", () => { post.remove(); });

  ensureObserver();
  io.observe(img);
  return post;
}

/* ÙŠØ¨Ù†ÙŠ URL */
function urlFor(folder, i){
  return `${IMAGE_ROOT}/${folder}/${i}.${EXT}`;
}

/* state Ù„Ù„Ù€ pagination */
let state = {
  cat: null,
  index: START_INDEX_IN_CATALOG,   // Ø±Ù‚Ù… Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ©
  folderIdx: 0,                     // Ù„Ù„ØªÙ†Ù‚Ù„ Ø¨ÙŠÙ† Ø§Ù„ÙÙˆÙ„Ø¯Ø±Ø§Øª ÙÙŠ all
  ended: false
};

function resetState(cat){
  state.cat = cat;
  state.index = START_INDEX_IN_CATALOG;
  state.folderIdx = 0;
  state.ended = false;
}

/* Ø²Ø± ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø²ÙŠØ¯ + Ù†Ù‡Ø§ÙŠØ© */
function renderFooterControls(){
  // Ø§Ù…Ø³Ø­ Ø£ÙŠ footer Ù‚Ø¯ÙŠÙ…
  const oldBtn = document.getElementById("loadMoreBtn");
  if(oldBtn) oldBtn.remove();
  const oldEnd = document.getElementById("endNote");
  if(oldEnd) oldEnd.remove();

  if(state.ended){
    const end = document.createElement("div");
    end.id = "endNote";
    end.className = "end-note";
    end.textContent = "Ø§Ù†ØªÙ‡Ù‰ Ø§Ù„ÙƒØªØ§Ù„ÙˆØ¬";
    feed.appendChild(end);
    return;
  }

  const btn = document.createElement("button");
  btn.id = "loadMoreBtn";
  btn.className = "load-more";
  btn.textContent = "ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø²ÙŠØ¯";
  btn.onclick = () => loadNextPage();
  feed.appendChild(btn);
}

/* ØªØ­Ù…ÙŠÙ„ Ø¯ÙØ¹Ø© ØµÙˆØ± */
function loadNextPage(){
  // Ø§Ø­Ø°Ù Ø²Ø± Ø§Ù„ØªØ­Ù…ÙŠÙ„ Ù‚Ø¨Ù„ Ø§Ù„Ø¥Ø¶Ø§ÙØ© Ø¹Ø´Ø§Ù† Ù…Ø§ ÙŠØªÙƒØ±Ø± Ø¨ÙŠÙ† Ø§Ù„Ù†Øµ
  const btn = document.getElementById("loadMoreBtn");
  if(btn) btn.remove();

  let added = 0;

  // Ø¥Ø°Ø§ Ù‚Ø³Ù… Ø¹Ø§Ø¯ÙŠ
  if(state.cat !== "all"){
    while(added < PAGE_SIZE && state.index <= MAX_PER_FOLDER){
      const u = urlFor(state.cat, state.index);
      feed.appendChild(makePost(u));
      state.index++;
      added++;
    }
    if(state.index > MAX_PER_FOLDER){
      state.ended = true;
    }
    renderFooterControls();
    return;
  }

  // Ù‚Ø³Ù… all: ÙŠÙ…Ø´ÙŠ ÙÙˆÙ„Ø¯Ø± ÙÙˆÙ„Ø¯Ø±
  while(added < PAGE_SIZE){
    if(state.folderIdx >= folders.length){
      state.ended = true;
      break;
    }

    const folder = folders[state.folderIdx];

    if(state.index > MAX_PER_FOLDER){
      // Ø®Ù„Øµ ÙÙˆÙ„Ø¯Ø± ÙˆØ§Ø¨Ø¯Ø£ Ø§Ù„ØªØ§Ù„ÙŠ
      state.folderIdx++;
      state.index = START_INDEX_IN_CATALOG;
      continue;
    }

    const u = urlFor(folder, state.index);
    feed.appendChild(makePost(u));
    state.index++;
    added++;
  }

  renderFooterControls();
}

/* Ø¹Ø±Ø¶ Ø§Ù„ÙƒØªØ§Ù„ÙˆØ¬ */
function renderFeed(cat){
  feed.innerHTML = '';
  resetState(cat);

  // Ø£ÙˆÙ„ Ø¯ÙØ¹Ø©
  loadNextPage();

  // Ø£Ø¹Ù„Ù‰ Ø§Ù„ØµÙØ­Ø©
  window.scrollTo(0,0);
}

function openCatalog(cat){
  // Ø§Ø­ÙØ¸ Ø³ÙƒØ±ÙˆÙ„ Ø§Ù„Ù‚Ø³Ù… Ø§Ù„Ø­Ø§Ù„ÙŠ Ù‚Ø¨Ù„ Ù…Ø§ ØªØºÙŠÙ‘Ø±
  if(currentCat){
    scrollMemory[currentCat] = window.scrollY;
  }

  currentCat = cat;

  homeView.classList.add('view-hidden');
  catalogView.classList.remove('view-hidden');
  catalogTitle.textContent = titles[cat] || 'Ø§Ù„ÙƒØªØ§Ù„ÙˆØ¬';

  renderFeed(cat);
}

function goBack(){
  // Ø§Ø­ÙØ¸ Ø³ÙƒØ±ÙˆÙ„ Ø§Ù„Ù‚Ø³Ù… Ø§Ù„Ø­Ø§Ù„ÙŠ
  if(currentCat){
    scrollMemory[currentCat] = window.scrollY;
  }

  catalogView.classList.add('view-hidden');
  homeView.classList.remove('view-hidden');
  window.scrollTo(0,0);

  currentCat = null;
}

/* thumbnails fallback */
function fixThumb(id, fallback){
  const img = document.getElementById(id);
  if(!img) return;
  img.onerror = () => { img.removeAttribute("src"); img.style.background = "var(--ph)"; };
  if(fallback) img.src = fallback;
}

window.addEventListener("load", () => {
  fixThumb("thumbBridal",  `${IMAGE_ROOT}/bridal/1.${EXT}`);
  fixThumb("thumbNewborn", `${IMAGE_ROOT}/newborn/1.${EXT}`);
  fixThumb("thumbBalloons",`${IMAGE_ROOT}/balloons/1.${EXT}`);
  fixThumb("thumbGrad",    `${IMAGE_ROOT}/grad/1.${EXT}`);
});
</script>
</body>
</html>
